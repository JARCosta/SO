#include "fs/operations.h"
#include <assert.h>
#include <string.h>

int main() {

    char *str = "1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000\n1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000";
    char *path = "/f1";
    char buffer[3030];

    assert(tfs_init() != -1);

    int f;
    ssize_t r;

    f = tfs_open(path, TFS_O_CREAT);
    assert(f != -1);

    r = tfs_write(f, str, strlen(str));
    assert(r == strlen(str));

    assert(tfs_close(f) != -1);

    f = tfs_open(path, 0);
    assert(f != -1);

    r = tfs_read(f, buffer, sizeof(buffer) - 1);
    buffer[r] = '\0';
    //printf("len(buffer): %ld len(str): %ld\n", strlen(buffer), strlen(str));
    //printf("%s\n",(char*)buffer);
    assert(r == strlen(str) && r == strlen(buffer));

    //printf("%s\n%s\n", buffer, str);
    assert(strcmp(buffer, str) == 0);

    assert(tfs_close(f) != -1);

    printf("Successful test.\n");

    return 0;
}
